# Generated by Django 4.2.7 on 2025-11-11 05:08

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ApprenticeProfile',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('lessons_completed', models.IntegerField(default=0)),
                ('total_scenarios_attempted', models.IntegerField(default=0)),
                ('total_scenarios_passed', models.IntegerField(default=0)),
                ('overall_expectancy', models.DecimalField(decimal_places=4, default=0, max_digits=10)),
                ('win_rate', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('avg_risk_per_trade', models.DecimalField(decimal_places=2, default=2.0, max_digits=5)),
                ('risk_consistency_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('stop_loss_adherence', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('avg_reward_risk_ratio', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('max_drawdown', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('discipline_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('journaling_quality_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('emotional_control_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('revenge_trade_count', models.IntegerField(default=0)),
                ('overconfidence_incidents', models.IntegerField(default=0)),
                ('learner_type', models.CharField(choices=[('analytical', 'Analytical - Detail-Oriented'), ('intuitive', 'Intuitive - Pattern Recognizer'), ('aggressive', 'Aggressive - High Risk Tolerance'), ('conservative', 'Conservative - Risk Averse'), ('undetermined', 'Undetermined')], default='undetermined', max_length=20)),
                ('skill_level', models.CharField(choices=[('novice', 'Novice'), ('beginner', 'Beginner'), ('intermediate', 'Intermediate'), ('advanced', 'Advanced'), ('expert', 'Expert')], default='novice', max_length=20)),
                ('pass_probability', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('strategy_proficiency', models.JSONField(default=dict)),
                ('current_difficulty', models.IntegerField(default=1)),
                ('max_position_size', models.DecimalField(decimal_places=2, default=10000, max_digits=10)),
                ('coaching_mode', models.CharField(choices=[('assisted', 'Assisted'), ('suggestions', 'Suggestions Only'), ('autonomous', 'Autonomous')], default='assisted', max_length=20)),
                ('is_certified', models.BooleanField(default=False)),
                ('certification_date', models.DateTimeField(blank=True, null=True)),
                ('certification_level', models.CharField(blank=True, max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'db_table': 'zenithmentor_apprentice_profile',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='BadgeAward',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('awarded_at', models.DateTimeField(auto_now_add=True)),
                ('awarded_for', models.TextField(help_text='Description of what triggered the award')),
                ('apprentice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='zenithmentor.apprenticeprofile')),
            ],
            options={
                'db_table': 'zenithmentor_badge_award',
                'ordering': ['-awarded_at'],
            },
        ),
        migrations.CreateModel(
            name='Lesson',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=200)),
                ('slug', models.SlugField(max_length=200, unique=True)),
                ('category', models.CharField(choices=[('foundation', 'Foundation'), ('trend', 'Trend Trading'), ('breakout', 'Breakout Trading'), ('mean_reversion', 'Mean Reversion'), ('volatility', 'Volatility Trading'), ('session_bias', 'Session & VWAP'), ('smc', 'Smart Money Concepts'), ('scalping', 'Scalping'), ('supply_demand', 'Supply & Demand'), ('prop_prep', 'Prop Challenge Prep'), ('certification', 'Certification')], max_length=30)),
                ('week', models.IntegerField(choices=[(0, 'Week 0'), (1, 'Week 1'), (2, 'Week 2'), (3, 'Week 3'), (4, 'Week 4'), (5, 'Week 5'), (6, 'Week 6'), (7, 'Week 7'), (8, 'Week 8'), (9, 'Week 9'), (10, 'Week 10'), (11, 'Week 11'), (12, 'Week 12')])),
                ('order', models.IntegerField(default=0)),
                ('description', models.TextField()),
                ('learning_objectives', models.TextField(help_text='Bullet points of what trainee will learn')),
                ('theory_content', models.TextField(help_text='Markdown formatted lesson content')),
                ('demo_chart_url', models.URLField(blank=True, help_text='Link to annotated chart example')),
                ('video_url', models.URLField(blank=True)),
                ('difficulty', models.IntegerField(default=1, help_text='1-10 scale')),
                ('min_skill_level', models.CharField(default='novice', max_length=20)),
                ('estimated_duration_minutes', models.IntegerField(default=30)),
                ('min_pass_score', models.DecimalField(decimal_places=2, default=70, max_digits=5)),
                ('required_scenarios', models.IntegerField(default=5, help_text='Number of scenarios trainee must complete')),
                ('is_published', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('prerequisites', models.ManyToManyField(blank=True, related_name='unlocks', to='zenithmentor.lesson')),
            ],
            options={
                'db_table': 'zenithmentor_lesson',
                'ordering': ['week', 'order'],
            },
        ),
        migrations.CreateModel(
            name='LessonStep',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('order', models.IntegerField(default=0)),
                ('step_type', models.CharField(choices=[('concept', 'Concept Explanation'), ('rules', 'Trading Rules'), ('demo', 'Annotated Demo'), ('mistakes', 'Common Mistakes'), ('risk_mgmt', 'Risk Management'), ('quiz', 'Knowledge Check'), ('simulation', 'Practice Simulation')], max_length=20)),
                ('title', models.CharField(max_length=200)),
                ('content', models.TextField(help_text='Markdown or HTML content')),
                ('quiz_questions', models.JSONField(blank=True, help_text='Array of question objects', null=True)),
                ('is_required', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('lesson', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='steps', to='zenithmentor.lesson')),
            ],
            options={
                'db_table': 'zenithmentor_lesson_step',
                'ordering': ['lesson', 'order'],
            },
        ),
        migrations.CreateModel(
            name='Scenario',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('regime', models.CharField(choices=[('trending_bull', 'Trending Bull'), ('trending_bear', 'Trending Bear'), ('ranging', 'Ranging/Choppy'), ('high_volatility', 'High Volatility'), ('low_volatility', 'Low Volatility'), ('breakout', 'Breakout Event'), ('reversal', 'Reversal Pattern'), ('news_driven', 'News-Driven')], max_length=30)),
                ('session', models.CharField(choices=[('asian', 'Asian Session'), ('london', 'London Session'), ('newyork', 'New York Session'), ('overlap', 'Session Overlap'), ('any', 'Any Session')], default='any', max_length=20)),
                ('strategy_focus', models.CharField(help_text='Primary strategy this scenario teaches', max_length=50)),
                ('difficulty', models.IntegerField(choices=[(1, 'Level 1'), (2, 'Level 2'), (3, 'Level 3'), (4, 'Level 4'), (5, 'Level 5'), (6, 'Level 6'), (7, 'Level 7'), (8, 'Level 8'), (9, 'Level 9'), (10, 'Level 10')], default=1)),
                ('symbol', models.CharField(default='EURUSD', max_length=20)),
                ('timeframe', models.CharField(default='15m', max_length=10)),
                ('start_date', models.DateTimeField(help_text='Historical window start')),
                ('end_date', models.DateTimeField(help_text='Historical window end')),
                ('candle_data', models.JSONField(help_text='Array of OHLCV candles')),
                ('has_synthetic_news', models.BooleanField(default=False)),
                ('synthetic_news_events', models.JSONField(blank=True, help_text='Injected news events', null=True)),
                ('volatility_multiplier', models.DecimalField(decimal_places=2, default=1.0, max_digits=5)),
                ('optimal_entry_price', models.DecimalField(blank=True, decimal_places=5, max_digits=20, null=True)),
                ('optimal_stop_loss', models.DecimalField(blank=True, decimal_places=5, max_digits=20, null=True)),
                ('optimal_take_profit', models.DecimalField(blank=True, decimal_places=5, max_digits=20, null=True)),
                ('optimal_direction', models.CharField(choices=[('long', 'Long'), ('short', 'Short'), ('neutral', 'Neutral')], default='neutral', max_length=10)),
                ('grading_criteria', models.JSONField(default=dict, help_text='Scoring weights and thresholds')),
                ('tags', models.JSONField(default=list, help_text='Array of string tags')),
                ('is_active', models.BooleanField(default=True)),
                ('usage_count', models.IntegerField(default=0)),
                ('avg_pass_rate', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_scenarios', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'zenithmentor_scenario',
                'ordering': ['difficulty', 'strategy_focus'],
            },
        ),
        migrations.CreateModel(
            name='SimulationRun',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('in_progress', 'In Progress'), ('completed', 'Completed'), ('abandoned', 'Abandoned'), ('paused', 'Paused')], default='in_progress', max_length=20)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('current_candle_index', models.IntegerField(default=0)),
                ('playback_speed', models.DecimalField(decimal_places=2, default=1.0, max_digits=5)),
                ('initial_balance', models.DecimalField(decimal_places=2, default=10000, max_digits=15)),
                ('final_balance', models.DecimalField(decimal_places=2, default=10000, max_digits=15)),
                ('final_pnl', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('max_drawdown', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('trades_count', models.IntegerField(default=0)),
                ('winning_trades', models.IntegerField(default=0)),
                ('losing_trades', models.IntegerField(default=0)),
                ('technical_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('risk_mgmt_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('execution_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('journaling_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('discipline_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('overall_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('passed', models.BooleanField(default=False)),
                ('coach_feedback', models.TextField(blank=True)),
                ('strengths', models.JSONField(default=list)),
                ('weaknesses', models.JSONField(default=list)),
                ('suggestions', models.JSONField(default=list)),
                ('trades_log', models.JSONField(default=list, help_text='Array of trade objects')),
                ('journal_entries', models.JSONField(default=list, help_text='Array of journal text entries')),
                ('coaching_interactions', models.JSONField(default=list, help_text='Array of coach messages')),
                ('apprentice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='simulation_runs', to='zenithmentor.apprenticeprofile')),
                ('lesson_step', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='simulation_runs', to='zenithmentor.lessonstep')),
                ('scenario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='simulation_runs', to='zenithmentor.scenario')),
            ],
            options={
                'db_table': 'zenithmentor_simulation_run',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TradeEntry',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('direction', models.CharField(choices=[('long', 'Long'), ('short', 'Short')], max_length=10)),
                ('entry_price', models.DecimalField(decimal_places=5, max_digits=20)),
                ('stop_loss', models.DecimalField(decimal_places=5, max_digits=20)),
                ('take_profit', models.DecimalField(blank=True, decimal_places=5, max_digits=20, null=True)),
                ('position_size', models.DecimalField(decimal_places=2, max_digits=15)),
                ('risk_amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('risk_percentage', models.DecimalField(decimal_places=2, max_digits=5)),
                ('reward_risk_ratio', models.DecimalField(decimal_places=2, max_digits=5)),
                ('entry_candle_index', models.IntegerField()),
                ('entry_timestamp', models.DateTimeField()),
                ('exit_price', models.DecimalField(blank=True, decimal_places=5, max_digits=20, null=True)),
                ('exit_candle_index', models.IntegerField(blank=True, null=True)),
                ('exit_timestamp', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('open', 'Open'), ('closed', 'Closed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('pnl', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('pnl_percentage', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('was_winner', models.BooleanField(null=True)),
                ('rationale', models.TextField(help_text='Why trainee took this trade')),
                ('rules_followed', models.JSONField(default=list, help_text='Array of rule names')),
                ('rules_broken', models.JSONField(default=list, help_text='Array of rule violations')),
                ('zenbot_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('coach_verdict', models.TextField(blank=True)),
                ('technical_validity', models.CharField(choices=[('valid', 'Valid'), ('marginal', 'Marginal'), ('invalid', 'Invalid')], default='valid', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('simulation_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='trades', to='zenithmentor.simulationrun')),
            ],
            options={
                'db_table': 'zenithmentor_trade_entry',
                'ordering': ['entry_candle_index'],
            },
        ),
        migrations.CreateModel(
            name='SkillBadge',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField()),
                ('category', models.CharField(choices=[('discipline', 'Discipline'), ('performance', 'Performance'), ('consistency', 'Consistency'), ('milestone', 'Milestone'), ('mastery', 'Strategy Mastery')], max_length=20)),
                ('requirement_criteria', models.JSONField(help_text='Dict of requirements to earn badge')),
                ('icon_name', models.CharField(help_text='Bootstrap icon name', max_length=50)),
                ('color', models.CharField(default='gold', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('apprentices', models.ManyToManyField(related_name='badges', through='zenithmentor.BadgeAward', to='zenithmentor.apprenticeprofile')),
            ],
            options={
                'db_table': 'zenithmentor_skill_badge',
                'ordering': ['category', 'name'],
            },
        ),
        migrations.CreateModel(
            name='MLModel',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('model_type', models.CharField(choices=[('apprentice_classifier', 'Apprentice Type Classifier'), ('pass_predictor', 'Pass Probability Predictor'), ('difficulty_recommender', 'Difficulty Recommender'), ('sentiment_analyzer', 'Journal Sentiment Analyzer')], max_length=50)),
                ('version', models.CharField(max_length=20)),
                ('model_file_path', models.CharField(help_text='Path to pickled model', max_length=500)),
                ('feature_names', models.JSONField(help_text='List of feature names in training order')),
                ('training_samples', models.IntegerField()),
                ('training_accuracy', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('training_notes', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=False)),
                ('deployed_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'db_table': 'zenithmentor_ml_model',
                'ordering': ['-created_at'],
                'unique_together': {('model_type', 'version')},
            },
        ),
        migrations.AddField(
            model_name='lessonstep',
            name='required_scenarios',
            field=models.ManyToManyField(blank=True, related_name='lesson_steps', to='zenithmentor.scenario'),
        ),
        migrations.CreateModel(
            name='CoachingSession',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('topic', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('recommendation', models.TextField(blank=True)),
                ('triggered_by', models.CharField(help_text='What event triggered this coaching', max_length=100)),
                ('datapoints', models.JSONField(default=dict, help_text='Technical/psychological data that informed the coaching')),
                ('ml_features_snapshot', models.JSONField(default=dict, help_text='Apprentice features at time of coaching')),
                ('apprentice_acknowledged', models.BooleanField(default=False)),
                ('apprentice_feedback', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('apprentice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='coaching_sessions', to='zenithmentor.apprenticeprofile')),
                ('simulation_run', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='coaching_sessions', to='zenithmentor.simulationrun')),
            ],
            options={
                'db_table': 'zenithmentor_coaching_session',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='badgeaward',
            name='badge',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='zenithmentor.skillbadge'),
        ),
        migrations.CreateModel(
            name='AssessmentResult',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('assessment_type', models.CharField(choices=[('quiz', 'Knowledge Quiz'), ('simulation', 'Graded Simulation'), ('prop_challenge', 'Prop Challenge'), ('certification', 'Certification Exam')], max_length=20)),
                ('score', models.DecimalField(decimal_places=2, max_digits=5)),
                ('max_score', models.DecimalField(decimal_places=2, default=100, max_digits=5)),
                ('passed', models.BooleanField(default=False)),
                ('questions_total', models.IntegerField(blank=True, null=True)),
                ('questions_correct', models.IntegerField(blank=True, null=True)),
                ('feedback', models.TextField(blank=True)),
                ('areas_of_strength', models.JSONField(default=list)),
                ('areas_for_improvement', models.JSONField(default=list)),
                ('attempted_at', models.DateTimeField(auto_now_add=True)),
                ('duration_minutes', models.IntegerField(blank=True, null=True)),
                ('apprentice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assessments', to='zenithmentor.apprenticeprofile')),
                ('lesson', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='assessments', to='zenithmentor.lesson')),
                ('simulation_runs', models.ManyToManyField(blank=True, related_name='assessments', to='zenithmentor.simulationrun')),
            ],
            options={
                'db_table': 'zenithmentor_assessment_result',
                'ordering': ['-attempted_at'],
            },
        ),
        migrations.AddField(
            model_name='apprenticeprofile',
            name='current_lesson',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='current_apprentices', to='zenithmentor.lesson'),
        ),
        migrations.AddField(
            model_name='apprenticeprofile',
            name='user',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='apprentice_profile', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddIndex(
            model_name='simulationrun',
            index=models.Index(fields=['apprentice', 'status'], name='zenithmento_apprent_6c37c1_idx'),
        ),
        migrations.AddIndex(
            model_name='simulationrun',
            index=models.Index(fields=['scenario', 'passed'], name='zenithmento_scenari_ec51af_idx'),
        ),
        migrations.AddIndex(
            model_name='scenario',
            index=models.Index(fields=['regime', 'difficulty'], name='zenithmento_regime_2843f9_idx'),
        ),
        migrations.AddIndex(
            model_name='scenario',
            index=models.Index(fields=['strategy_focus'], name='zenithmento_strateg_0b822f_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='lessonstep',
            unique_together={('lesson', 'order')},
        ),
        migrations.AlterUniqueTogether(
            name='lesson',
            unique_together={('week', 'order')},
        ),
        migrations.AlterUniqueTogether(
            name='badgeaward',
            unique_together={('apprentice', 'badge')},
        ),
    ]
